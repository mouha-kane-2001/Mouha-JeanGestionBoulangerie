<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0"><i class="fas fa-boxes me-2"></i>Liste des produits</h2>
    <a routerLink="/admin/produits/ajouter" class="btn btn-success">
      <i class="fas fa-plus-circle me-1"></i>Ajouter un produit
    </a>
  </div>

  <div class="card shadow-sm border-0">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th scope="col" class="ps-4">#</th>
              <th scope="col">Image</th>
              <th scope="col">Nom</th>
              <th scope="col">Description</th>
              <th scope="col">Prix</th>
              <th scope="col">Stock</th>
              <th scope="col">Catégorie</th>
              <th scope="col" class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of produits; let i = index">
              <td class="ps-4 fw-bold">{{ i + 1 }}</td>
              <td>
                <div class="product-img-container">
<img *ngIf="p.photo" [src]="p.photo" [alt]="p.nom" class="product-img">
                  <div *ngIf="!p.photo" class="product-img-placeholder">
                    <i class="fas fa-image"></i>
                  </div>
                </div>
              </td>
              <td class="fw-semibold">{{ p.nom }}</td>
              <td class="text-truncate max-description">{{ p.description || '—' }}</td>


                <td>
  <span *ngIf="p.prix_promotion; else prixNormal">
    <span class="text-muted text-decoration-line-through me-2">
      {{ p.prix  | number:'1.0-0' }} FCFA
    </span>
    <span class="fw-bold text-success">
      {{ p.prix_promotion | number:'1.0-0' }} FCFA
    </span>
  </span>
  <ng-template #prixNormal>
    <span class="fw-bold text-primary">
      {{ p.prix | number:'1.0-0' }} FCFA
    </span>
  </ng-template>
</td>

              <td>
                <span class="badge" [ngClass]="{
                  'bg-success': p.stock > 20,
                  'bg-warning': p.stock > 0 && p.stock <= 20,
                  'bg-danger': p.stock === 0
                }">
                  {{ p.stock }}
                </span>
              </td>
              <td>
                <span class="badge bg-secondary">{{ p.categorie?.nom }}</span>
              </td>
              <td>
                <div class="d-flex justify-content-center gap-2">
                  <button class="btn btn-sm btn-outline-primary" (click)="modifierProduit(p)">
                    <i class="fas fa-edit me-1"></i>Modifier
                  </button>
                  <button class="btn btn-sm btn-outline-danger" (click)="supprimerProduit(p.id)">
                    <i class="fas fa-trash-alt me-1"></i>Supprimer
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<style>
  .product-img-container {
    width: 60px;
    height: 60px;
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f8f9fa;
    border: 1px solid #e9ecef;
  }

  .product-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .product-img-placeholder {
    color: #adb5bd;
    font-size: 1.5rem;
  }

  .max-description {
    max-width: 250px;
  }

  .table-hover tbody tr:hover {
    background-color: rgba(13, 110, 253, 0.05) !important;
  }

  .fw-semibold {
    font-weight: 500;
  }

  .card {
    border-radius: 12px;
  }
</style>
