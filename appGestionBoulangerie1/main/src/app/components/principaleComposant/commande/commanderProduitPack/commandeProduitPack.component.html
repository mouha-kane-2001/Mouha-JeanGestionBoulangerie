<div class="container mt-4">
  <h2 class="mb-4 text-center">Choisir des Produits et Packs</h2>

  <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
    <p class="mt-2">Chargement des produits et packs...</p>
  </div>

  <!-- Section Produits -->
  <div *ngIf="!loading && produits.length > 0" class="mb-5">
    <h3 class="mb-3 border-bottom pb-2">Produits</h3>
    <div class="row g-3">
      <div *ngFor="let produit of produits" class="col-md-4">
        <div class="card h-100">
          <img [src]="produit.photo || 'assets/images/default-product.jpg'"
               class="card-img-top"
               [alt]="produit.nom"
               style="height: 200px; object-fit: cover;">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ produit.nom }}</h5>
            <p class="card-text flex-grow-1">{{ produit.description || 'Aucune description' }}</p>

<p>
  <span *ngIf="produit.prix_promotion; else prixNormal">
    <span class="text-muted text-decoration-line-through me-2">
      {{ produit.prix | currency:'EUR':'symbol':'1.2-2' }}
    </span>
    <span class="fw-bold text-success">
      {{ produit.prix_promotion | currency:'EUR':'symbol':'1.2-2' }}
    </span>
  </span>
  <ng-template #prixNormal>
    <span class="fw-bold text-primary">
      {{ produit.prix | currency:'EUR':'symbol':'1.2-2' }}
    </span>
  </ng-template>
</p>

            <button class="btn btn-primary mt-auto"
                    (click)="ajouterProduitAuPanier(produit)">
              <i class="bi bi-cart-plus"></i> Ajouter au panier
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Section Packs -->
  <div *ngIf="!loading && packs.length > 0" class="mb-5">
    <h3 class="mb-3 border-bottom pb-2">Packs</h3>
    <div class="row g-3">
      <div *ngFor="let pack of packs" class="col-md-4">
        <div class="card h-100">
       <img *ngIf="pack.photo" [src]="'http://localhost:8000/storage/' + pack.photo"

               class="card-img-top"
               [alt]="pack.nom"
               style="height: 200px; object-fit: cover;">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ pack.nom }}</h5>
            <p class="card-text flex-grow-1">{{ pack.description || 'Aucune description' }}</p>
            <p class="fw-bold text-success">{{ pack.prix | currency:'EUR':'symbol':'1.2-2' }}</p>
            <div class="mb-2">
              <small class="text-muted">Contient {{ pack.produits.length }} produit(s)</small>
            </div>
            <button class="btn btn-primary mt-auto"
                    (click)="ajouterPackAuPanier(pack)">
              <i class="bi bi-cart-plus"></i> Ajouter au panier
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && produits.length === 0 && packs.length === 0" class="text-center py-5">
    <i class="bi bi-inbox display-1 text-muted"></i>
    <h4 class="mt-3 text-muted">Aucun produit ou pack disponible</h4>
  </div>
</div>
